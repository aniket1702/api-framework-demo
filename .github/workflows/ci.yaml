on:
    push:
        branches:
            - master
jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v2
            - name: Set up JDK
              uses: actions/setup-java@v1
              with:
                  java-version: 11
            - name: Install Maven
              run: |
                  sudo apt-get update
                  sudo apt-get install -y maven
            - name: Build the project
              run: |
                  mvn clean compile
            - name: Install Node.js
              run: sudo apt-get install -y nodejs
            - name: Install json-server
              run: npm install -g json-server
            - name: Moving to resources folder
              run: cd src/test/resources
            - name: Run json-server
              run: json-server db.json --port=8080 &
            - name: Run tests
              run: |
                  mvn test
deploy:
    runs-on: ubuntu-latest
    needs: build
    if: success()
    steps:
        - name: Deploy to production
          run: |
              # commands to deploy the jar file to production here